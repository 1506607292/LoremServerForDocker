(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[6],{"35c1":function(e,t,s){},"4a0b":function(e,t,s){"use strict";s("35c1")},"4ec3":function(e,t,s){"use strict";s.d(t,"d",(function(){return n})),s.d(t,"j",(function(){return i})),s.d(t,"f",(function(){return o})),s.d(t,"h",(function(){return r})),s.d(t,"g",(function(){return u})),s.d(t,"c",(function(){return c})),s.d(t,"e",(function(){return d})),s.d(t,"b",(function(){return l})),s.d(t,"i",(function(){return p})),s.d(t,"a",(function(){return m}));var a=s("b775");const n=e=>Object(a["a"])({url:"/api/question/answer",method:"get",params:e}),i=(e,t)=>Object(a["a"])({url:"/api/question/answer",method:"post",params:e,data:t}),o=e=>Object(a["a"])({url:"/api/user/login",method:"post",data:e}),r=e=>Object(a["a"])({url:"/api/user/register",method:"post",data:e}),u=e=>Object(a["a"])({url:"/api/user/logout",method:"post",data:e}),c=e=>Object(a["a"])({url:"/api/user/getcaptcha",method:"get",data:e}),d=e=>Object(a["a"])({url:"/api/user/userinfo",method:"get",data:e}),l=e=>Object(a["a"])({url:"/api/user/userinfo",method:"put",data:e}),p=e=>Object(a["a"])({url:"/api/user/changepw",method:"post",data:e}),m=e=>Object(a["a"])({url:"/api/user/changepw",method:"put",data:e})},b775:function(e,t,s){"use strict";(function(e){var a=s("bc3a"),n=s.n(a),i=s("2a19");const o=n.a.create({baseURL:e.env.VUE_APP_BASE_API,timeout:99999,withCredentials:!0});o.interceptors.request.use((e=>(e.data=JSON.stringify(e.data),e.headers={"Content-Type":"application/json"},e)),(e=>(i["a"].create({message:e.toString(),color:"negative",position:"top",timeout:2e3,icon:"warning"}),e))),o.interceptors.response.use((e=>{switch(e.data.code){case 0:return e;case 1:return i["a"].create({message:e.data.message.toString(),color:"warning",position:"top",timeout:2e3}),setTimeout((()=>{document.cookie="username=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",document.cookie="token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",location.reload()}),500),e;case 2:return i["a"].create({message:e.data.message.toString(),color:"orange",position:"top",timeout:2e3}),e;case-1:return i["a"].create({message:"系统错误",color:"deep-orange-14",position:"top",timeout:2e3}),e;case 7:return i["a"].create({message:e.data.message.toString(),color:"warning",position:"top",timeout:2e3}),e;default:return e}}),(e=>(i["a"].create({message:e.toString(),color:"negative",position:"top",timeout:2e3,icon:"warning"}),e))),t["a"]=o}).call(this,s("4362"))},e3ba:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("q-page",{staticClass:"main-con ",class:{"flex flex-center column":!e.showQuestions}},[e.loading?s("div",{staticClass:"flex flex-center text-secondary text-h7"},[s("q-inner-loading",{attrs:{showing:""}},[s("q-spinner-gears",{attrs:{size:"50px",color:"secondary"}}),s("br"),e._v("\n      加载中...\n    ")],1)],1):e.demoMode||103===e.surveyData.statusCode?s("div",{staticClass:"flex column items-stretch"},[s("div",{staticClass:"paper-header"},[s("div",{staticClass:"text-h4 text-center paper-title"},[e._v(e._s(e.demoMode?e.sdata.title:e.surveyData.title))]),e.$route.params.token?s("div",{staticClass:"text-center paper-time"},[e._v("ID:"+e._s(e.$route.params.token.toUpperCase()))]):e._e(),s("br"),s("div",{domProps:{innerHTML:e._s(e.demoMode?e.sdata.desc:e.surveyData.desc)}})]),e.showQuestions?e._e():s("div",{staticClass:"text-center q-pa-lg"},[s("q-space"),s("q-btn",{attrs:{outline:"",icon:"arrow_downward",color:"secondary",round:""},on:{click:e.startQuiz}},[s("q-tooltip",{attrs:{"content-class":"desktop-only"}},[e._v("\n          开始问卷\n        ")])],1)],1),s("transition",{attrs:{name:"fade"}},[e.showQuestions?s("q-form",{ref:"surveyForm",staticClass:"column",attrs:{autocorrect:"off",autocapitalize:"off",spellcheck:"false"},on:{"validation-error":e.validError}},[e._l(e.demoMode?e.sdata.questionSet:e.surveyData.questionSet,(function(t,a){return s("div",{key:a,staticClass:"ques-section"},[e.loading?e._e():s("q-separator",{staticClass:"q-mb-sm",staticStyle:{background:"rgba(0, 0, 0, 0.05)"},attrs:{size:"2px"}}),0===t.type?s("div",[s("div",{staticClass:"text-h6 ques-title-large"},[s("b",[e._v(e._s(e._f("formatIndex")(t.index))+" / ")]),""!==t.title?s("span",[e._v(e._s(t.title))]):s("span",{staticClass:"text-italic text-grey"},[e._v("(未设置题目)")]),t.need?s("span",{staticClass:"text-red"},[e._v(" *")]):e._e()]),e.demoMode?s("q-input",{attrs:{disable:1===e.submitted,placeholder:"请输入",dense:!0,filled:"",rules:[function(e){return!t.need||null!=e&&""!=e||"必填项"}]},model:{value:e.answer[a],callback:function(t){e.$set(e.answer,a,t)},expression:"answer[i]"}}):s("q-input",{attrs:{disable:1===e.submitted,placeholder:"请输入",dense:!0,filled:"",rules:[function(e){return!t.need||null!=e&&""!=e||"必填项"}]},on:{keydown:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;t.preventDefault()}},model:{value:e.answer.questionSet[a].answer,callback:function(t){e.$set(e.answer.questionSet[a],"answer",t)},expression:"answer.questionSet[i].answer"}})],1):1===t.type?s("div",[s("div",{staticClass:"text-h6 ques-title"},[s("b",[e._v(e._s(e._f("formatIndex")(t.index))+" / ")]),""!==t.title?s("span",[e._v(e._s(t.title))]):s("span",{staticClass:"text-italic text-grey"},[e._v("(未设置题目)")]),t.need?s("span",{staticClass:"text-red"},[e._v(" *")]):e._e()]),e.demoMode?s("q-field",{attrs:{rules:[function(e){return!t.need||null!=e||"必填项"}],borderless:"",disable:1===e.submitted},scopedSlots:e._u([{key:"control",fn:function(){return[s("q-option-group",{attrs:{options:t.options,color:"primary",type:"radio"},model:{value:e.answer[a],callback:function(t){e.$set(e.answer,a,t)},expression:"answer[i]"}})]},proxy:!0}],null,!0),model:{value:e.answer[a],callback:function(t){e.$set(e.answer,a,t)},expression:"answer[i]"}}):s("q-field",{attrs:{rules:[function(e){return!t.need||null!=e||"必填项"}],borderless:"",disable:1===e.submitted},scopedSlots:e._u([{key:"control",fn:function(){return[s("q-option-group",{attrs:{options:t.options,color:"primary",type:"radio"},model:{value:e.answer.questionSet[a].answer,callback:function(t){e.$set(e.answer.questionSet[a],"answer",t)},expression:"answer.questionSet[i].answer"}})]},proxy:!0}],null,!0),model:{value:e.answer.questionSet[a].answer,callback:function(t){e.$set(e.answer.questionSet[a],"answer",t)},expression:"answer.questionSet[i].answer"}})],1):e._e()],1)})),s("q-btn",{staticClass:"flex-center submit-btn",attrs:{label:1===e.submitted?"提交成功":"提交",color:1===e.submitted?"secondary":"primary",disable:0!==e.submitted,loading:-1===e.submitted},on:{click:e.submit}})],2):e._e()],1)],1):104===e.surveyData.statusCode?s("div",{staticClass:"flex flex-center text-secondary text-h5 q-mt-lg"},[e._v("\n    您已提交此问卷\n  ")]):s("div",{staticClass:"flex flex-center text-secondary text-h5 q-mt-lg"},[e._v("\n    问卷已停止收集\n  ")]),s("br"),e.loading?e._e():s("q-separator",{staticClass:"q-ma-md"}),e.loading?e._e():s("div",{staticClass:"paper-footer text-center",class:{"fixed-bottom":!e.showQuestions},staticStyle:{height:"100px"}},[e._v("\n    Copyright © 2021 LoremIpsum Team\n    "),s("br"),e._v("\n    问卷系统由"),s("a",{staticClass:"no-wrap q-link",attrs:{href:"/"}},[e._v("LoremSurvey")]),e._v("提供\n    "),s("br"),s("a",{staticClass:"q-link",attrs:{href:"#"}},[e._v("意见反馈")])])],1)},n=[],i=(s("4e82"),s("2a19")),o=s("4ec3"),r={name:"survey",props:{sdata:Object},data(){return{surveyData:{title:"",desc:"",questionSet:[]},answer:{questionSet:[]},submitted:0,res:null,sessionId:null,demoMode:!1,loading:!0,showQuestions:!1}},mounted(){},async created(){if(!this.$route.params.token)return this.demoMode=!0,void(this.loading=!1);this.sessionId=this.$route.params.token;const e=await Object(o["d"])({sessionid:this.sessionId});if(this.surveyData=e.data.data,105===this.surveyData.statusCode&&await this.$router.push("/survey"),103===this.surveyData.statusCode){document.title=this.surveyData.title+" -LoremSurvey",this.surveyData.running||(this.submitted=1),this.surveyData.questionSet.sort(((e,t)=>e.index>t.index?1:-1));for(let e=0;e<this.surveyData.questionSet.length;++e)(1===this.surveyData.questionSet[e].type||0===this.surveyData.questionSet[e].type)&&this.answer.questionSet.push({index:e+1,answer:null,id:this.surveyData.questionSet[e].id})}this.loading=!1},filters:{formatIndex:function(e){return e<10?"0"+e:e}},methods:{startQuiz(){this.showQuestions=!0},submit(){this.$refs.surveyForm.validate().then((e=>{if(e){if(this.demoMode)return i["a"].create({message:"模拟提交动作，不会收集数据",color:"secondary",position:"top",timeout:500}),this.submitted=-1,void setTimeout((()=>{this.submitted=1}),1e3);this.submitted=-1,Object(o["j"])({sessionid:this.sessionId},{questionSet:this.answer.questionSet}).then((e=>{0===e.data.code?this.submitted=1:this.submitted=0}))}}))},validError(){i["a"].create({message:"存在未填项",color:"negative",position:"top",timeout:1500,icon:"warning"})}}},u=r,c=(s("4a0b"),s("2877")),d=s("9989"),l=s("74f7"),p=s("cf57"),m=s("2c91"),f=s("9c40"),h=s("05c0"),v=s("0378"),b=s("eb85"),g=s("27f9"),w=s("8572"),y=s("9f0a"),x=s("eebe"),q=s.n(x),_=Object(c["a"])(u,a,n,!1,null,"007cd7c0",null);t["default"]=_.exports;q()(_,"components",{QPage:d["a"],QInnerLoading:l["a"],QSpinnerGears:p["a"],QSpace:m["a"],QBtn:f["a"],QTooltip:h["a"],QForm:v["a"],QSeparator:b["a"],QInput:g["a"],QField:w["a"],QOptionGroup:y["a"]})}}]);