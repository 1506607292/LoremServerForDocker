(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[12],{b775:function(e,t,a){"use strict";(function(e){var s=a("bc3a"),n=a.n(s),o=a("2a19"),l=a("2b27"),i=a.n(l);const r=n.a.create({baseURL:e.env.VUE_APP_BASE_API,timeout:99999,withCredentials:!0});r.interceptors.request.use((e=>{let t=null;return i.a.isKey("csrftoken")&&(t=i.a.get("csrftoken")),e.data=JSON.stringify(e.data),e.headers={"Content-Type":"application/json","X-CSRFToken":t},e}),(e=>(o["a"].create({message:e.toString(),color:"negative",position:"top",timeout:2e3,icon:"warning"}),e))),r.interceptors.response.use((e=>{switch(e.data.code){case 0:return e;case 1:return o["a"].create({message:e.data.message.toString(),color:"warning",position:"top",timeout:2e3}),setTimeout((()=>{document.cookie="username=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",document.cookie="token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;",location.reload()}),500),e;case 2:return o["a"].create({message:e.data.message.toString(),color:"orange",position:"top",timeout:2e3}),e;case-1:return o["a"].create({message:"系统错误",color:"deep-orange-14",position:"top",timeout:2e3}),e;case 7:return o["a"].create({message:e.data.message.toString(),color:"warning",position:"top",timeout:2e3}),e;default:return e}}),(e=>(o["a"].create({message:e.toString(),color:"negative",position:"top",timeout:2e3,icon:"warning"}),e))),t["a"]=r}).call(this,a("4362"))},e498:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("q-page",{staticClass:"flex justify-center"},[a("div",{staticClass:"work-area"},[a("div",{staticClass:"q-pa-md"},[a("q-table",{attrs:{title:"受访者列表",data:e.data,columns:e.columns,"row-key":"name","selected-rows-label":e.getSelectedString,selection:"multiple",selected:e.selected},on:{"update:selected":function(t){e.selected=t}},scopedSlots:e._u([{key:"top-right",fn:function(){return[a("div",{staticClass:"flex row"},[a("q-btn",{attrs:{color:"primary"},on:{click:function(t){e.upload=!0}}},[e._v("上传\n            ")]),a("q-space",{staticStyle:{width:"10px"}}),a("q-btn",{attrs:{color:"red",disable:0===e.selected.length},on:{click:e.onDel}},[e._v("删除\n              "+e._s(e.selected.length>0?e.selected.length+" 人":"")+"\n            ")])],1)]},proxy:!0}])})],1),a("q-dialog",{on:{hide:e.getData},model:{value:e.upload,callback:function(t){e.upload=t},expression:"upload"}},[a("q-card",{staticClass:"q-pa-sm bg-grey-2"},[a("q-card-section",[a("div",{staticClass:"text-h6"},[e._v("上传受访者名单(.XLS/.XLSX)")])]),a("q-separator"),a("q-card-section",[a("q-uploader",{attrs:{url:e.URL,accept:".xls,.xlsx","max-files":"1",bordered:"",headers:"X-CSRFToken:"+e.token}})],1)],1)],1)],1)])},n=[],o=a("b775");const l=e=>Object(o["a"])({url:"/api/question/respondent",method:"get",data:e}),i=e=>Object(o["a"])({url:"/api/question/respondent",method:"delete",data:e});var r=a("2b27"),c=a.n(r),d={name:"Respondents",data(){return{selected:[],upload:!1,token:"",columns:[{name:"id",required:!0,label:"学号/工号",field:"id",sortable:!0},{name:"name",label:"姓名",field:"name",sortable:!0},{name:"school",label:"学校",field:"school",sortable:!0},{name:"sex",label:"性别",field:"sex"},{name:"phone",label:"手机号",field:"phone"},{name:"email",label:"邮箱",field:"email"}],data:[],URL:"/api/question/respondents"}},created(){this.getData(),c.a.isKey("csrftoken")&&(this.token=c.a.get("csrftoken"))},methods:{getData(){l().then((e=>{this.data=e.data.data}))},getSelectedString(){return 0===this.selected.length?"":`${this.selected.length} record${this.selected.length>1?"s":""} selected of ${this.data.length}`},onDel(){let e=[];for(let t=0;t<this.selected.length;t++)e.push(this.selected[t].id);i(e).then((()=>{this.getData()}))}}},u=d,p=a("2877"),g=a("9989"),m=a("eb85"),h=a("eaac"),b=a("9c40"),f=a("2c91"),k=a("24e8"),S=a("f09f"),q=a("a370"),w=a("ee89"),v=a("eebe"),x=a.n(v),C=Object(p["a"])(u,s,n,!1,null,"50c663b8",null);t["default"]=C.exports;x()(C,"components",{QPage:g["a"],QSeparator:m["a"],QTable:h["a"],QBtn:b["a"],QSpace:f["a"],QDialog:k["a"],QCard:S["a"],QCardSection:q["a"],QUploader:w["a"]})}}]);